{"version":3,"file":"login-81c0b522.js","sources":["../src/app/core/util/ContensisManagementApi.js","../src/app/features/login/transformations/mapClientCredentials.js","../src/app/features/login/util/CookieHelper.class.js","../src/app/features/login/util/OidcUserManager.js","../src/app/features/login/util/LoginHelper.class.js","../src/app/features/login/redux/sagas/login.js"],"sourcesContent":["// import { Client } from 'contensis-management-api';\r\n\r\nexport const getManagementApiClient = async ({\r\n  bearerToken,\r\n  bearerTokenExpiryDate,\r\n  refreshToken,\r\n  refreshTokenExpiryDate,\r\n  contensisClassicToken,\r\n  username,\r\n  password,\r\n}) => {\r\n  const rootUrl = SERVERS.api || SERVERS.cms; /* global SERVERS */\r\n  const projectId = PROJECTS[0].id; /* global PROJECTS */\r\n\r\n  let config = {};\r\n  if (refreshToken) {\r\n    config = {\r\n      clientType: 'contensis_classic_refresh_token',\r\n      clientDetails: {\r\n        refreshToken,\r\n      },\r\n    };\r\n  } else {\r\n    config = {\r\n      clientType: 'contensis_classic',\r\n      clientDetails: {\r\n        username,\r\n        password,\r\n      },\r\n    };\r\n  }\r\n  const { Client } = await import('contensis-management-api');\r\n\r\n  const client = Client.create({\r\n    ...config,\r\n    projectId,\r\n    rootUrl,\r\n  });\r\n\r\n  if (bearerToken) client.bearerToken = bearerToken;\r\n  if (bearerTokenExpiryDate)\r\n    client.bearerTokenExpiryDate = bearerTokenExpiryDate;\r\n  if (refreshToken) client.refreshToken = refreshToken;\r\n  if (refreshTokenExpiryDate)\r\n    client.refreshTokenExpiryDate = refreshTokenExpiryDate;\r\n  if (contensisClassicToken)\r\n    client.contensisClassicToken = contensisClassicToken;\r\n\r\n  return client;\r\n};\r\n","import { mapJson } from '~/core/util/json-mapper';\r\n\r\nconst clientCredentials = {\r\n  bearerToken: 'bearerToken',\r\n  bearerTokenExpiryDate: ({ bearerTokenExpiryDate }) =>\r\n    bearerTokenExpiryDate.toISOString(),\r\n  refreshToken: 'refreshToken',\r\n  refreshTokenExpiryDate: ({ refreshTokenExpiryDate }) =>\r\n    refreshTokenExpiryDate.toISOString(),\r\n  contensisClassicToken: 'contensisClassicToken',\r\n};\r\nexport default obj => mapJson(obj, clientCredentials);\r\n","import Cookies from 'js-cookie';\r\n\r\nconst COOKIE_VALID_DAYS = 1; // 0 = Session cookie\r\n\r\n// Override the default js-cookie conversion / encoding\r\n// methods so the written values work with Contensis sites\r\nconst _cookie = Cookies.withConverter({\r\n  read: value => decodeURIComponent(value),\r\n  write: value => encodeURIComponent(value),\r\n});\r\n\r\nexport class CookieHelper {\r\n  static GetCookie(name) {\r\n    let cookie = _cookie.get(name);\r\n    if (typeof cookie == 'undefined') {\r\n      return null;\r\n    }\r\n    return cookie;\r\n  }\r\n\r\n  static SetCookie(name, value, maxAgeDays = COOKIE_VALID_DAYS) {\r\n    maxAgeDays === 0\r\n      ? _cookie.set(name, value)\r\n      : _cookie.set(name, value, { expires: maxAgeDays });\r\n  }\r\n\r\n  static DeleteCookie(name) {\r\n    _cookie.remove(name);\r\n  }\r\n}\r\n","const context = typeof window != 'undefined' ? window : global;\r\nconst requireOidc =\r\n  process.env.NODE_ENV === 'development'\r\n    ? WSFED_LOGIN === 'true' /* global WSFED_LOGIN */\r\n    : context.WSFED_LOGIN === 'true';\r\n\r\nconst servers = SERVERS; /* global SERVERS */\r\n\r\nconst userManagerConfig =\r\n  typeof window !== 'undefined'\r\n    ? {\r\n        authority: `${servers.cms}/authenticate/`,\r\n        client_id: 'WebsiteAdfsClient',\r\n        redirect_uri: window.location.toString(),\r\n        post_logout_redirect_uri: window.location.toString(),\r\n        response_type: 'id_token',\r\n        scope: 'openid',\r\n        filterProtocolClaims: false,\r\n      }\r\n    : {};\r\n\r\nconst createUserManager = config => {\r\n  if (typeof window !== 'undefined' && requireOidc) {\r\n    try {\r\n      const UserManager = require('oidc-client').UserManager;\r\n      return new UserManager(config);\r\n    } catch (e) {\r\n      //\r\n    }\r\n  } else return {};\r\n};\r\n\r\nconst userManager = createUserManager(userManagerConfig);\r\n\r\nexport default userManager;\r\n","/* eslint-disable require-atomic-updates */\r\nimport { getManagementApiClient } from '~/core/util/ContensisManagementApi';\r\nimport { to } from 'await-to-js';\r\n\r\nimport { CookieHelper } from './CookieHelper.class';\r\n\r\nimport mapClientCredentials from '../transformations/mapClientCredentials';\r\nimport userManager from './OidcUserManager';\r\n\r\nexport const LOGIN_COOKIE = 'ContensisCMSUserName';\r\nexport const REFRESH_TOKEN_COOKIE = 'RefreshToken';\r\n\r\nconst context = typeof window != 'undefined' ? window : global;\r\n\r\nexport class LoginHelper {\r\n  static CMS_URL = SERVERS.cms /* global SERVERS */;\r\n  static WSFED_LOGIN =\r\n    process.env.NODE_ENV === 'development'\r\n      ? WSFED_LOGIN === 'true' /* global WSFED_LOGIN */\r\n      : context.WSFED_LOGIN === 'true';\r\n  static LOGIN_ROUTE = '/account/login';\r\n  static ACCESS_DENIED_ROUTE = '/account/access-denied';\r\n\r\n  static SetLoginCookies({ contensisClassicToken, refreshToken }) {\r\n    if (contensisClassicToken)\r\n      CookieHelper.SetCookie(LOGIN_COOKIE, contensisClassicToken);\r\n    if (refreshToken)\r\n      CookieHelper.SetCookie(REFRESH_TOKEN_COOKIE, refreshToken);\r\n  }\r\n\r\n  static GetCachedCredentials() {\r\n    return {\r\n      bearerToken: null,\r\n      bearerTokenExpiryDate: null,\r\n      refreshToken: CookieHelper.GetCookie(REFRESH_TOKEN_COOKIE),\r\n      refreshTokenExpiryDate: null,\r\n      contensisClassicToken: CookieHelper.GetCookie(LOGIN_COOKIE),\r\n    };\r\n  }\r\n\r\n  static ClearCachedCredentials() {\r\n    CookieHelper.DeleteCookie(LOGIN_COOKIE);\r\n    CookieHelper.DeleteCookie(REFRESH_TOKEN_COOKIE);\r\n  }\r\n\r\n  static async LoginUser({ username, password, clientCredentials }) {\r\n    let credentials = clientCredentials;\r\n    let authenticationState = {\r\n      authenticated: false,\r\n      authenticationError: false,\r\n      error: false,\r\n      clientCredentials: null,\r\n    };\r\n    let transientClient;\r\n    let user;\r\n\r\n    if (username && password) {\r\n      // Get a management client with username and password\r\n      transientClient = await getManagementApiClient({\r\n        username,\r\n        password,\r\n      });\r\n\r\n      // Ensure the client has requested a bearer token\r\n      const [loginError, clientBearerToken] = await to(\r\n        transientClient.ensureBearerToken()\r\n      );\r\n\r\n      // Problem getting token with username and password\r\n      if (loginError) {\r\n        const authenticationError = loginError.name.includes(\r\n          'ContensisAuthenticationError'\r\n        );\r\n        authenticationState = {\r\n          authenticated: false,\r\n          authenticationError: authenticationError,\r\n          error: !authenticationError,\r\n          clientCredentials: null,\r\n        };\r\n        LoginHelper.ClearCachedCredentials();\r\n      }\r\n\r\n      // Got a token using username and password\r\n      if (clientBearerToken) {\r\n        // Set credentials so we can continue to GetUserDetails\r\n        credentials = mapClientCredentials(transientClient);\r\n        LoginHelper.SetLoginCookies(credentials);\r\n        authenticationState = {\r\n          authenticated: true,\r\n          authenticationError: false,\r\n          error: false,\r\n          clientCredentials: credentials,\r\n        };\r\n      }\r\n    }\r\n\r\n    // If we have credentials supplied by a successful username and password login\r\n    // or clientCredentials supplied in the options argument we can continue to\r\n    // fetch the user's details\r\n    if (credentials) {\r\n      const client =\r\n        transientClient || (await getManagementApiClient(credentials));\r\n      const [error, userDetails] = await LoginHelper.GetUserDetails(client);\r\n\r\n      if (error) {\r\n        authenticationState = {\r\n          authenticated: false,\r\n          authenticationError: false,\r\n          error: { message: error.message, stack: error.stack },\r\n          clientCredentials: null,\r\n        };\r\n        LoginHelper.ClearCachedCredentials();\r\n      } else {\r\n        user = userDetails;\r\n        authenticationState = {\r\n          authenticated: true,\r\n          authenticationError: false,\r\n          error: false,\r\n          clientCredentials: credentials,\r\n        };\r\n      }\r\n    }\r\n\r\n    return { authenticationState, user };\r\n  }\r\n\r\n  static GetUserDetails = async client => {\r\n    let userError,\r\n      groupsError,\r\n      user = {},\r\n      groupsResult;\r\n\r\n    [userError, user] = await to(client.security.users.getCurrent());\r\n    if (user && user.id) {\r\n      [groupsError, groupsResult] = await to(\r\n        client.security.users.getUserGroups({\r\n          userId: user.id,\r\n          includeInherited: true,\r\n        })\r\n      );\r\n      // Set groups attribute in user object to be the items\r\n      // array from the getUserGroups result\r\n      if (groupsResult && groupsResult.items) user.groups = groupsResult.items;\r\n\r\n      //If groups call fails then log the error but allow the user to login still\r\n      // eslint-disable-next-line no-console\r\n      if (groupsError) console.log(groupsError);\r\n    }\r\n    return [userError, user];\r\n  };\r\n\r\n  static LogoutUser(redirectPath) {\r\n    LoginHelper.ClearCachedCredentials();\r\n    if (LoginHelper.WSFED_LOGIN) {\r\n      LoginHelper.WsFedLogout(redirectPath);\r\n    } else {\r\n      if (redirectPath) LoginHelper.ClientRedirectToPath(redirectPath);\r\n      else LoginHelper.ClientRedirectToSignInPage();\r\n    }\r\n  }\r\n\r\n  static ClientRedirectToHome(location) {\r\n    if (typeof window != 'undefined') {\r\n      let url = '/';\r\n      if (location) {\r\n        const { search, hash } = location.toJS();\r\n        url = search ? `${url}${search}` : url;\r\n        url = hash ? `${url}${hash}` : url;\r\n      }\r\n      window.location.href = url;\r\n    }\r\n  }\r\n\r\n  static async ClientRedirectToSignInPage(redirectPath) {\r\n    if (LoginHelper.WSFED_LOGIN) {\r\n      await LoginHelper.WsFedLogout();\r\n      LoginHelper.WsFedLogin();\r\n    } else {\r\n      // Standard Contensis Login\r\n      let url = LoginHelper.LOGIN_ROUTE;\r\n      if (typeof redirectPath === 'string')\r\n        url = `${url}?redirect_uri=${redirectPath}`;\r\n      if (\r\n        typeof location !== 'undefined' &&\r\n        redirectPath !== LoginHelper.LOGIN_ROUTE\r\n      )\r\n        location.replace(url);\r\n    }\r\n  }\r\n\r\n  static ClientRedirectToAccessDeniedPage(originalPath) {\r\n    let url = LoginHelper.ACCESS_DENIED_ROUTE;\r\n    if (originalPath === url) return;\r\n\r\n    if (typeof originalPath === 'string')\r\n      url = `${url}?original_uri=${originalPath}`;\r\n    if (typeof location !== 'undefined') location.href = url;\r\n  }\r\n\r\n  static ClientRedirectToPath(redirectPath) {\r\n    if (typeof redirectPath === 'string') {\r\n      if (typeof location !== 'undefined') window.location.href = redirectPath;\r\n    } else LoginHelper.ClientRedirectToHome();\r\n  }\r\n\r\n  static WsFedLogin(redirectUri) {\r\n    userManager.signinRedirect({\r\n      scope: 'openid',\r\n      response_type: 'id_token',\r\n      redirect_uri: redirectUri || window.location.toString(),\r\n    });\r\n  }\r\n\r\n  static async WsFedLogout(redirectPath) {\r\n    await fetch(\r\n      `${LoginHelper.CMS_URL}/authenticate/logout?jsonResponseRequired=true`,\r\n      {\r\n        credentials: 'include',\r\n      }\r\n    );\r\n    if (redirectPath) {\r\n      window.location = redirectPath;\r\n    }\r\n  }\r\n\r\n  static async GetCredentialsForSecurityToken(securityToken) {\r\n    const [error, response] = await to(\r\n      fetch(`${LoginHelper.CMS_URL}/REST/Contensis/Security/IsAuthenticated`, {\r\n        method: 'POST',\r\n        headers: {\r\n          Accept: 'application/json',\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({\r\n          securityToken: encodeURIComponent(securityToken),\r\n        }),\r\n      })\r\n    );\r\n    if (error) return [{ message: 'Failed to fetch credentials' }];\r\n    if (response.ok) {\r\n      const [parseError, body] = await to(response.json());\r\n      if (parseError) return [parseError];\r\n\r\n      const { LogonResult, ApplicationData = [] } = body;\r\n      if (LogonResult !== 0) {\r\n        return [\r\n          { message: 'Security token is invalid', data: ApplicationData },\r\n        ];\r\n      }\r\n      if (\r\n        ApplicationData.length > 1 &&\r\n        ApplicationData[1].Key === 'ContensisSecurityRefreshToken'\r\n      ) {\r\n        const refreshToken = ApplicationData[1].Value;\r\n        return [undefined, refreshToken];\r\n      } else {\r\n        return [\r\n          {\r\n            message:\r\n              'Fetch credentials: Unable to find ContensisSecurityRefreshToken',\r\n          },\r\n        ];\r\n      }\r\n    } else {\r\n      return [\r\n        {\r\n          message: `Fetch credentials error: ${response.status} ${response.statusText}`,\r\n        },\r\n      ];\r\n    }\r\n  }\r\n\r\n  static isZengentiStaff(email) {\r\n    const emailRefs = ['@zengenti', '@contensis'];\r\n\r\n    return emailRefs.some(emailRef => {\r\n      if (email.includes(emailRef)) {\r\n        return true;\r\n      }\r\n    });\r\n  }\r\n}\r\n","import { Map } from 'immutable';\r\nimport { takeEvery, select, put, call } from 'redux-saga/effects';\r\nimport {\r\n  SET_AUTHENTICATION_STATE,\r\n  LOGIN_USER,\r\n  LOGOUT_USER,\r\n  VALIDATE_USER,\r\n} from '../types';\r\nimport {\r\n  selectUserIsAuthenticated,\r\n  selectClientCredentials,\r\n  selectUserGroups,\r\n} from '../selectors';\r\n\r\nimport { setRoute } from '~/core/redux/actions/routing';\r\nimport { selectCurrentSearch } from '~/core/redux/selectors/routing';\r\nimport { getManagementApiClient } from '~/core/util/ContensisManagementApi';\r\nimport { findContentTypeMapping } from '~/core/util/helpers';\r\nimport { queryParams } from '~/core/util/navigation';\r\nimport mapClientCredentials from '../../transformations/mapClientCredentials';\r\nimport { LoginHelper } from '../../util/LoginHelper.class';\r\nimport { matchUserGroup } from '../../util/matchGroups';\r\n\r\nexport const loginSagas = [\r\n  takeEvery(LOGIN_USER, loginUserSaga),\r\n  takeEvery(LOGOUT_USER, logoutUserSaga),\r\n  takeEvery(VALIDATE_USER, validateUserSaga),\r\n  takeEvery(SET_AUTHENTICATION_STATE, redirectAfterSuccessfulLoginSaga),\r\n];\r\n\r\nexport function* handleRequiresLoginSaga(action) {\r\n  const {\r\n    entry,\r\n    requireLogin,\r\n    routes: { ContentTypeMappings },\r\n    staticRoute,\r\n  } = action;\r\n  let userLoggedIn = yield select(selectUserIsAuthenticated);\r\n\r\n  // Check for a securityToken in querystring\r\n  const currentQs = queryParams(yield select(selectCurrentSearch));\r\n  const securityToken = currentQs.securityToken || currentQs.securitytoken;\r\n\r\n  // Check if any of the defined routes have \"requireLogin\" attribute\r\n  const { requireLogin: authRoute } = (staticRoute && staticRoute.route) || {};\r\n  const { requireLogin: authContentType } =\r\n    (entry &&\r\n      findContentTypeMapping(ContentTypeMappings, entry.sys.contentTypeId)) ||\r\n    {};\r\n\r\n  // If requireLogin, authRoute or authContentType has been specified as an\r\n  // array of groups we can merge all the arrays and match on any group supplied\r\n  const routeRequiresGroups = [\r\n    ...((Array.isArray(authContentType) && authContentType) || []),\r\n    ...((Array.isArray(authRoute) && authRoute) || []),\r\n    ...((Array.isArray(requireLogin) && requireLogin) || []),\r\n  ];\r\n  const routeRequiresLogin = !!authContentType || !!authRoute || !!requireLogin;\r\n\r\n  if (!userLoggedIn) {\r\n    // If cookies or securityToken are found on any route change\r\n    // always validate and login the user\r\n    if (routeRequiresLogin) {\r\n      // If routeRequiresLogin do a blocking call that returns userLoggedIn\r\n      userLoggedIn = yield call(validateUserSaga, { securityToken });\r\n    }\r\n    // otherwise do a non blocking put to handle validation in the background\r\n    else yield put({ type: VALIDATE_USER, securityToken });\r\n  }\r\n\r\n  if (routeRequiresLogin) {\r\n    // If a security token is in the querystring and we are not already\r\n    // logged in something is wrong and we won't bother going on another redirect loop\r\n    if (!userLoggedIn && !securityToken) {\r\n      LoginHelper.ClientRedirectToSignInPage(action.location.pathname);\r\n    } else if (routeRequiresGroups.length > 0) {\r\n      const userGroups = (yield select(selectUserGroups)).toJS();\r\n      const groupMatch = matchUserGroup(userGroups, routeRequiresGroups);\r\n\r\n      if (!groupMatch)\r\n        LoginHelper.ClientRedirectToAccessDeniedPage(action.location.pathname);\r\n    }\r\n  }\r\n}\r\n\r\nfunction* validateUserSaga({ securityToken }) {\r\n  if (securityToken) {\r\n    // If we have just a security token we will call a CMS endpoint\r\n    // and provide us with a RefreshToken cookie we can use during login\r\n    const [\r\n      error,\r\n      refreshToken,\r\n    ] = yield LoginHelper.GetCredentialsForSecurityToken(securityToken);\r\n    if (refreshToken)\r\n      LoginHelper.SetLoginCookies({\r\n        contensisClassicToken: securityToken,\r\n        refreshToken,\r\n      });\r\n    if (error)\r\n      yield put({\r\n        type: SET_AUTHENTICATION_STATE,\r\n        authenticationState: {\r\n          error: { message: error.message, stack: error.stack },\r\n        },\r\n      });\r\n  }\r\n\r\n  // Check for refreshToken in cookies\r\n  const clientCredentials = LoginHelper.GetCachedCredentials();\r\n\r\n  // Log the user in if a refreshToken is found\r\n  if (clientCredentials.refreshToken)\r\n    yield call(loginUserSaga, { clientCredentials });\r\n\r\n  // Tell any callers have we successfully logged in?\r\n  return yield select(selectUserIsAuthenticated);\r\n}\r\n\r\nfunction* loginUserSaga(action = {}) {\r\n  const { username, password, clientCredentials } = action;\r\n\r\n  // If a WSFED_LOGIN site has dispatched the loginUser action\r\n  // just redirect them to the Identity Provider sign in\r\n  if (action.type === LOGIN_USER && LoginHelper.WSFED_LOGIN)\r\n    LoginHelper.ClientRedirectToSignInPage();\r\n\r\n  const { authenticationState, user } = yield LoginHelper.LoginUser({\r\n    username,\r\n    password,\r\n    clientCredentials,\r\n  });\r\n\r\n  yield put({\r\n    type: SET_AUTHENTICATION_STATE,\r\n    authenticationState,\r\n    user,\r\n  });\r\n}\r\n\r\nfunction* redirectAfterSuccessfulLoginSaga() {\r\n  const isLoggedIn = yield select(selectUserIsAuthenticated);\r\n  const redirectPath = queryParams(yield select(selectCurrentSearch))\r\n    .redirect_uri;\r\n\r\n  if (isLoggedIn && redirectPath) {\r\n    yield put(setRoute(redirectPath));\r\n  }\r\n}\r\n\r\nfunction* logoutUserSaga({ redirectPath }) {\r\n  yield put({\r\n    type: SET_AUTHENTICATION_STATE,\r\n    user: null,\r\n  });\r\n  yield LoginHelper.LogoutUser(redirectPath);\r\n}\r\n\r\nexport function* refreshSecurityToken() {\r\n  const clientCredentials = (\r\n    (yield select(selectClientCredentials)) || Map()\r\n  ).toJS();\r\n  if (Object.keys(clientCredentials).length > 0) {\r\n    const client = yield getManagementApiClient(clientCredentials);\r\n    yield client.authenticate();\r\n\r\n    const authenticationState = {};\r\n\r\n    const newClientCredentials = mapClientCredentials(client);\r\n\r\n    authenticationState.clientCredentials = newClientCredentials;\r\n\r\n    yield put({\r\n      type: SET_AUTHENTICATION_STATE,\r\n      authenticationState,\r\n    });\r\n  }\r\n}\r\n"],"names":["getManagementApiClient","bearerToken","bearerTokenExpiryDate","refreshToken","refreshTokenExpiryDate","contensisClassicToken","username","password","rootUrl","SERVERS","api","cms","projectId","PROJECTS","id","config","clientType","clientDetails","Client","client","create","clientCredentials","toISOString","obj","mapJson","COOKIE_VALID_DAYS","_cookie","Cookies","withConverter","read","value","decodeURIComponent","write","encodeURIComponent","CookieHelper","GetCookie","name","cookie","get","SetCookie","maxAgeDays","set","expires","DeleteCookie","remove","context","window","global","requireOidc","process","env","NODE_ENV","WSFED_LOGIN","servers","userManagerConfig","authority","client_id","redirect_uri","location","toString","post_logout_redirect_uri","response_type","scope","filterProtocolClaims","createUserManager","UserManager","require","e","userManager","LOGIN_COOKIE","REFRESH_TOKEN_COOKIE","LoginHelper","SetLoginCookies","GetCachedCredentials","ClearCachedCredentials","LoginUser","credentials","authenticationState","authenticated","authenticationError","error","transientClient","user","loginError","clientBearerToken","to","ensureBearerToken","includes","mapClientCredentials","userDetails","GetUserDetails","message","stack","LogoutUser","redirectPath","WsFedLogout","ClientRedirectToPath","ClientRedirectToSignInPage","ClientRedirectToHome","url","search","hash","toJS","href","WsFedLogin","LOGIN_ROUTE","replace","ClientRedirectToAccessDeniedPage","originalPath","ACCESS_DENIED_ROUTE","redirectUri","signinRedirect","fetch","CMS_URL","GetCredentialsForSecurityToken","securityToken","response","method","headers","Accept","body","JSON","stringify","ok","parseError","json","LogonResult","ApplicationData","data","length","Key","Value","undefined","status","statusText","isZengentiStaff","email","emailRefs","some","emailRef","userError","groupsError","groupsResult","security","users","getCurrent","getUserGroups","userId","includeInherited","items","groups","console","log","loginSagas","takeEvery","LOGIN_USER","loginUserSaga","LOGOUT_USER","logoutUserSaga","VALIDATE_USER","validateUserSaga","SET_AUTHENTICATION_STATE","redirectAfterSuccessfulLoginSaga","handleRequiresLoginSaga","action","entry","requireLogin","routes","ContentTypeMappings","staticRoute","userLoggedIn","select","selectUserIsAuthenticated","currentQs","queryParams","selectCurrentSearch","securitytoken","authRoute","route","authContentType","findContentTypeMapping","sys","contentTypeId","routeRequiresGroups","Array","isArray","routeRequiresLogin","call","put","type","pathname","userGroups","selectUserGroups","groupMatch","matchUserGroup","isLoggedIn","setRoute","refreshSecurityToken","selectClientCredentials","Map","Object","keys","authenticate","newClientCredentials"],"mappings":"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"}